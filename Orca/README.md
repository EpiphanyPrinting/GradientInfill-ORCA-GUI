# Gradientinfill for Orca slicer:
If you are running the script from orcaslicer there will be just one output file. I recommend testing the script first inside of an IDE and compare the original and modified file.

The following part was originally written as a [guide for prusa slicer](https://github.com/WatchingWatches/GradientInfill/tree/master/Prusa), but the slicer settings are the same, but might be found at a different location.
## Introduction what changed?:
This is a fork of the repository of CNC-Kitchen. I didn't change the working principal of the script. I mainly adapted the comments within the gcode file to suit those generated by Orca slicer and changed a few things which resulted in errors previously (used re patterns instead of searching for single characters in line). To understand better how the script works, i recommend watching the YouTube video and reading the README.md in the mainfolder. There you can also find instructions to install python (I'm using python 3.9.18 with the anaconda distribution). To my knowledge this is the first version working in Prusa slicer. If i'm mistaken, please let me know.
### First example print:
It's difficult to see the different line width of the infill on the picture. The test piece also needs to be large enough.
![first example](pictures/IMG_20240321_223411411.jpg)

![different line width](pictures/gcode_preview.png)
## Features:
- The script can be called directly after slicing with an optional dialog in the terminal, which will automatically open (``run_in_slicer = True``)
- It's also possible to run the script inside of an IDE (``run_in_slicer = False``)
- If the script didn't do any changes it will print a message. This means something went wrong.
- If a bug occurs the error message will be written inside of the terminal. When this happens please review, that all of the entered settings are correct. Open an issue here at this repository and share all your variables and the error message to get help.

## Slicer settings (enable advanced mode):
### Disable Arc fitting in print settings-> advanced:
![arc fitting](<pictures/Screenshot 2024-03-21 231928.png>)

### Use relative extrusion in printer settings-> general:

![Relative extrusion](<pictures/Screenshot 2024-03-21 232256.png>)

### Infill before perimeter need to be turned off printer settings-> infill:

![Infill](pictures/image.png)

### Automatically call script when saving the file:
![run script](pictures/image-2.png)

Insert the path to your python.exe followed by the path to the python script in print settings -> output options.

## Running script:
The script gets called after the slicing process. 
This means, that the preview inside of the slicer doesn't show the changes of the script.

### Investigate the modified gcode (recommended):
The following steps are recommended and should be performed every time, until you trust the script. There might be errors specific to your gcode, which i haven't thought of. Those could potentially damage your printer.

Open the file inside of a gcode viewer (drag the gcode file into orca slicer), to take a look at the modified gcode. Select the line width color scheme to see the difference. 
Open the two files inside of notepad++ and compare both files with a plugin called "compare". The program will mark all of the changes in between both files. This is the safest check, since the gcode previewer can give a wrong impression.

## General advice:
Experiment with the different parameters. For me a ``MAX_FLOW = 350`` was set too high and 250 worked better.

Print small test pieces to test your settings. The test pieces don't need to be tall, but the infill section needs to be large enough, so you can actually see the difference in line width.
You may need to lower the infill speed, since the flow increases with the use of the script.
Check in the preview, that it's not exceeding the maximum flow of the hotend. The line width of the infill shouldn't be much higher than the nozzle diameter in the slicer setting.

When you look at the second picture you can see that the flow in the inner core (outside of the ``GRADIENT_THICKNESS`` range) isn't changed. If you want a thin infill width in the core (where the forces are the lowest)
you can choose a small linewidth as infill linewidth, set ``MIN_FLOW = 100`` and adjust ``MAX_FLOW`` accordingly (increase).

If you modify a big file the computing time can be several minutes long.
I tried adding a progress bar, but it nearly doubled the execution time, so i removed it.

## Prospect for the future:
I will try to optimize the calculation time of the script.
With your help i will debug the script for errors, which might occur.

I might add an option, which modifies the Infill speed, to prevent exceeding the maximum flow. 

You may also be interested in my own postprocessing scripts, which can be found [here](https://github.com/WatchingWatches/Post_processing_gcode).

Thank you for you feedback in advance. Also feel free to adapt the script to other slicers too.